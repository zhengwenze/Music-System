import{_ as e,e as a}from"./index.cfbf38c0.js";import{aA as l,r as s,j as i,o as t,ac as o,y as n,D as r,G as c,E as u,F as d,am as m,z as v,u as g,R as p,M as f,S as y,a5 as h,U as w,$ as k,H as b}from"./vendor.1112e821.js";import{g as _,a as C,s as L,b as V,c as I,u as U,d as x,r as S}from"./songList.fbb575fc.js";import{s as j}from"./music.3b750384.js";import{u as E}from"./upload.2e887d46.js";import{b as N,a as A,r as D,g as R,c as T,d as z}from"./mylike.b9b8a089.js";import{E as P,i as $}from"./element-plus.c63ee1ff.js";import"./axios.468b7dd2.js";const B={class:"container",key:"songlist-container"},K={class:"header"},M={class:"header-actions"},O={class:"search-section"},q={key:0,class:"songlist-grid"},F=["onClick"],G={class:"songlist-cover"},H=["src","alt"],J={class:"songlist-info"},Q={class:"songlist-name"},W={class:"songlist-desc"},X={class:"songlist-actions"},Y=["onClick"],Z=["onClick"],ee=["onClick","disabled"],ae={key:0,class:"songlist-grid"},le=["onClick"],se={class:"songlist-cover"},ie=["src","alt"],te={class:"songlist-info"},oe={class:"songlist-name"},ne={class:"songlist-desc"},re={class:"songlist-actions"},ce=["onClick","disabled"],ue={key:0,class:"songlist-grid"},de=["onClick"],me={class:"songlist-cover"},ve=["src","alt"],ge={class:"songlist-info"},pe={class:"songlist-name"},fe={class:"songlist-desc"},ye={class:"songlist-actions"},he=["onClick","disabled"],we={key:1,class:"empty-like-lists"},ke={key:0,class:"songlist-grid"},be=["onClick"],_e={class:"songlist-cover"},Ce=["src","alt"],Le={class:"songlist-info"},Ve={class:"songlist-name"},Ie={class:"songlist-desc"},Ue={class:"songlist-actions"},xe=["onClick","disabled"],Se={key:0,class:"songlist-detail"},je={class:"detail-header"},Ee=["src","alt"],Ne={class:"detail-info"},Ae={class:"detail-content"},De=["src","alt"],Re={key:1},Te={key:1},ze=["src"],Pe={key:1,class:"upload-placeholder"},$e={class:"dialog-header"},Be={class:"songlist-detail-container"},Ke={class:"songlist-detail-header"},Me={class:"songlist-cover-large"},Oe=["src","alt"],qe={class:"songlist-info-large"},Fe={class:"songlist-name-large"},Ge={class:"songlist-desc-large"},He={class:"songlist-stats"},Je={class:"song-search-box"},Qe={key:0,class:"songs-list"},We={class:"song-item"},Xe=["src","alt","onClick"],Ye=["onClick"],Ze={class:"song-name"},ea={key:1,class:"empty-search-results"},aa={key:2,class:"empty-songs"},la={class:"song-search-container"},sa={class:"search-section"},ia={class:"songs-search-results"},ta={class:"song-item"},oa=["src","alt"],na={class:"song-name"};var ra=e({__name:"Index",setup(e){const ra=l((()=>a((()=>import("./musicPlayer.10ac923a.js")),["assets/musicPlayer.10ac923a.js","assets/musicPlayer.78314e69.css","assets/index.cfbf38c0.js","assets/index.12a402db.css","assets/vendor.1112e821.js","assets/axios.468b7dd2.js","assets/element-plus.c63ee1ff.js"]))),ca=s("mySongList"),ua=s(""),da=s(!1),ma=s([]),va=s([]),ga=s([]),pa=s(!1),fa=s(!1),ya=s(null),ha=s(null),wa=s(!1),ka=s({}),ba=s([]),_a=s(!1),Ca=s(""),La=s([]),Va=s([]),Ia=s(null),Ua=s(""),xa=s([]),Sa=s(""),ja=s(!1),Ea=s(null),Na=s(new Set),Aa=s(!1),Da=s(!1),Ra=s(new Set),Ta=s([]),za=s(!1),Pa=s(!1),$a=async()=>{var e;Pa.value=!0;try{const a=await N();if(a&&a.data,a.data&&(a.data.success||20===a.data.code)){const l=(null==(e=a.data.data)?void 0:e.likeSongList)||[];Ta.value=l;const s=new Set(l.map((e=>e.id)));Ra.value=s,l.forEach((e=>{e.isLike=1}))}else P.error("获取收藏歌单列表失败")}catch(a){a.response,P.error("加载收藏歌单列表失败")}finally{Pa.value=!1}},Ba=async e=>{if(!za.value){za.value=!0;try{const a=e.id;if(Ra.value.has(a)){const l=await z(a);20===l.code||l.success||200===l.code?(e.isLike=0,Ra.value.delete(a),P.success("取消收藏成功"),"likeSongList"===ca.value&&(Ta.value=Ta.value.filter((e=>e.id!==a)))):P.error(l.message||"取消收藏失败，请稍后重试")}else{const l=await T(a);20===l.code||l.success||200===l.code?(e.isLike=1,Ra.value.add(a),P.success("收藏成功")):P.error(l.message||"收藏失败，请稍后重试")}}catch(a){a.response,P.error("操作失败，请稍后重试")}finally{za.value=!1}}},Ka=e=>{e&&e.musicUrl?0!==e.activation?(Sa.value=e.musicUrl,ja.value=!0,Ea.value&&Ea.value.play&&Ea.value.play()):P.error("这个歌曲已被下架，无法播放！"):P.warning("该歌曲暂无音频链接")},Ma=()=>{const e=Ua.value.trim().toLowerCase();xa.value=e?ba.value.filter((a=>a.name&&a.name.toLowerCase().includes(e)||a.singerName&&a.singerName.toLowerCase().includes(e)||a.albumName&&a.albumName.toLowerCase().includes(e))):[...ba.value]},Oa=()=>{Ua.value="",xa.value=[...ba.value]},qa=()=>{Ia.value=ka.value.id,_a.value=!0},Fa=()=>{_a.value=!1,Ca.value="",La.value=[],Va.value=[]},Ga=i({name:"",message:"",tags:"",image:""}),Ha={name:[{required:!0,message:"请输入歌单名称",trigger:"blur"},{min:1,max:50,message:"歌单名称长度在 1 到 50 个字符",trigger:"blur"}],message:[{max:200,message:"歌单简介最多200个字符",trigger:"blur"}],tags:[{max:100,message:"标签最多100个字符",trigger:"blur"}]},Ja=e=>{if(!e)return"";return new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"})},Qa=async()=>{if(Ca.value.trim())try{const e=await j(Ca.value);e.data.success||20===e.data.code?La.value=e.data.data.list||[]:(P.error(e.data.message||"搜索歌曲失败"),La.value=[])}catch(e){P.error("搜索失败，请稍后重试"),La.value=[]}else P.warning("请输入搜索关键词")},Wa=e=>{Va.value=e},Xa=async()=>{if(0!==Va.value.length)if(Ia.value)try{let a=0,l=0;const s=[];for(const i of Va.value)try{const e=await V(i.musicId,Ia.value);e.data.success||20===e.data.code?a++:(l++,s.push(i.musicName))}catch(e){l++,s.push(i.musicName)}a>0&&P.success(`成功添加 ${a} 首歌曲到歌单`),l>0&&P.warning(`有 ${l} 首歌曲添加失败: ${s.join(", ")}`),Fa(),a>0&&await ll(Ia.value)}catch(e){P.error("操作失败，请稍后重试")}else P.error("歌单ID无效");else P.warning("请先选择要添加的歌曲")},Ya=()=>{wa.value=!1,ka.value={},ba.value=[]};t((()=>{Za(),el(),$a()}));const Za=async()=>{var e,l;try{const{getUserId:s}=await a((()=>import("./index.cfbf38c0.js").then((function(e){return e.n}))),["assets/index.cfbf38c0.js","assets/index.12a402db.css","assets/vendor.1112e821.js","assets/axios.468b7dd2.js","assets/element-plus.c63ee1ff.js"]),i=s();if(!i)return void P.warning("请先登录");const t=await _(i);t&&t.data&&(t.data.success||20===t.data.code)?(ma.value=(null==(e=t.data.data)?void 0:e.list)||[],ma.value.forEach((e=>{}))):P.error((null==(l=null==t?void 0:t.data)?void 0:l.message)||"获取我的歌单失败")}catch(s){P.error("获取我的歌单失败，请稍后重试")}},el=async()=>{var e,a,l;try{const s=await C();s&&s.data&&(s.data.success||20===s.data.code)?va.value=(null==(e=s.data.data)?void 0:e.songList)||(null==(a=s.data.data)?void 0:a.list)||[]:P.error((null==(l=null==s?void 0:s.data)?void 0:l.message)||"加载推荐歌单失败")}catch(s){P.error("网络错误，请稍后重试")}},al=async()=>{var e,a;if(ua.value.trim())try{ca.value="searchResult",da.value=!0;const l=await L(ua.value);l&&l.data&&(l.data.success||20===l.data.code)?ga.value=(null==(e=l.data.data)?void 0:e.songList)||[]:P.error((null==(a=null==l?void 0:l.data)?void 0:a.message)||"搜索失败")}catch(l){P.error("网络错误，请稍后重试")}else P.warning("请输入搜索关键词")},ll=async e=>{var a,l,s;try{Ia.value=e;const i=await I(e);i&&i.data&&(i.data.success||20===i.data.code)?(ka.value=(null==(a=i.data.data)?void 0:a.listMessage)||{},ba.value=(null==(l=i.data.data)?void 0:l.musicList)||[],xa.value=[...ba.value],Ua.value="",wa.value=!0,await(async()=>{var e,a;Da.value=!0;try{const l=await R();Array.isArray(l)?Na.value=new Set(l.map((e=>e.musicId))):l.data&&Array.isArray(null==(e=l.data.data)?void 0:e.likelist)?Na.value=new Set(l.data.data.likelist.map((e=>e.musicId))):l.data&&Array.isArray(null==(a=l.data)?void 0:a.likelist)&&(Na.value=new Set(l.data.likelist.map((e=>e.musicId))))}catch(l){}finally{Da.value=!1}})()):P.error((null==(s=null==i?void 0:i.data)?void 0:s.message)||"获取歌单详情失败")}catch(i){P.error("获取歌单详情失败，请稍后重试")}},sl=e=>{ca.value=e,"mySongList"===e?Za():"recommendList"===e?el():"likeSongList"===e&&$a()},il=e=>{if(!/\.(jpg|jpeg|png|gif|bmp)$/i.test(e.name))return P.error("只支持上传图片格式（jpg、jpeg、png、gif、bmp）！"),!1;return!!(e.size/1024/1024<2)||(P.error("图片大小不能超过2MB！"),!1)},tl=async e=>{const{file:a}=e;try{const l=await E(a);if(l&&(l.success||20===l.code||200===l.code||l.url)){let a;if(l.data&&l.data.url)a=l.data.url;else if(l.url)a=l.url;else{if("string"!=typeof l)throw new Error("返回数据结构不正确");a=l}Ga.image=a,P.success("图片上传成功"),e.onSuccess&&e.onSuccess()}else{const a=(null==l?void 0:l.message)||"图片上传失败";P.error(a),e.onError&&e.onError()}}catch(l){P.error("上传失败，请稍后重试"),e.onError&&e.onError(l)}},ol=async()=>{try{await Promise.all([Za(),el()]),P.success("歌单数据已刷新")}catch(e){P.error("刷新失败，请稍后重试")}},nl=()=>{ua.value="",ol()},rl=async()=>{var e;try{if(!Ga.image)return void P.error("请上传歌单封面图片");const a={name:Ga.name,description:Ga.message,image:Ga.image,tags:Ga.tags};let l;if(ha.value){if(!ha.value.id)return void P.error("编辑失败: 歌单ID无效");l=await U(ha.value.id,a)}else l=await x(a);l&&l.data&&(l.data.success||20===l.data.code||200===l.data.code)?(P.success(ha.value?"编辑成功":"创建成功"),fa.value=!1,Ga.name="",Ga.message="",Ga.tags="",Ga.image="",ha.value=null,Za()):P.error((null==(e=null==l?void 0:l.data)?void 0:e.message)||(ha.value?"编辑失败":"创建失败"))}catch(a){P.error("网络错误，请稍后重试")}};return(e,l)=>{const s=o("el-button"),i=o("el-input"),t=o("el-tab-pane"),_=o("el-tabs"),C=o("el-table-column"),L=o("el-table"),V=o("el-skeleton"),I=o("el-dialog"),U=o("el-form-item"),x=o("el-upload"),j=o("el-form"),E=o("el-empty");return n(),r(f,null,[c("div",B,[c("div",K,[l[14]||(l[14]=c("h2",null,"我的歌单",-1)),c("div",M,[u(s,{type:"primary",onClick:l[0]||(l[0]=e=>fa.value=!0)},{default:d((()=>[...l[13]||(l[13]=[y("创建歌单",-1)])])),_:1})])]),c("div",O,[u(i,{modelValue:ua.value,"onUpdate:modelValue":l[1]||(l[1]=e=>ua.value=e),placeholder:"搜索歌单","prefix-icon":"el-icon-search",clearable:"",class:"search-input",onKeyup:m(al,["enter"])},null,8,["modelValue"]),u(s,{type:"primary",onClick:al},{default:d((()=>[...l[15]||(l[15]=[y("搜索",-1)])])),_:1}),u(s,{type:"primary",onClick:nl},{default:d((()=>[...l[16]||(l[16]=[y("重置",-1)])])),_:1}),u(s,{type:"primary",onClick:ol},{default:d((()=>[...l[17]||(l[17]=[y("刷新",-1)])])),_:1})]),u(_,{modelValue:ca.value,"onUpdate:modelValue":l[2]||(l[2]=e=>ca.value=e),onTabChange:sl},{default:d((()=>[u(t,{label:"我的歌单",name:"mySongList"},{default:d((()=>[ma.value.length>0?(n(),r("div",q,[(n(!0),r(f,null,h(ma.value,(e=>(n(),r("div",{key:e.id,class:"songlist-item",onClick:a=>ll(e.id)},[c("div",G,[c("img",{src:e.image||e.titleImg||"/music.png",alt:e.name},null,8,H)]),c("div",J,[c("h3",Q,w(e.name),1),c("p",W,w(e.message||"暂无简介"),1)]),c("div",X,[c("button",{onClick:k((a=>(e=>{ha.value=e,Ga.name=e.name,Ga.message=e.message||"",Ga.tags=e.tags||"",Ga.image=e.image||e.titleImg||"",fa.value=!0})(e)),["stop"])},"编辑",8,Y),c("button",{onClick:k((l=>{return s=e.id,void $.confirm("确定要删除这个歌单吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{var e;try{const{getUserId:l}=await a((()=>import("./index.cfbf38c0.js").then((function(e){return e.n}))),["assets/index.cfbf38c0.js","assets/index.12a402db.css","assets/vendor.1112e821.js","assets/axios.468b7dd2.js","assets/element-plus.c63ee1ff.js"]),i=l(),t=await S(s,i);t&&t.data&&(t.data.success||20===t.data.code)?(P.success("删除成功"),"mySongList"===ca.value&&Za()):P.error((null==(e=null==t?void 0:t.data)?void 0:e.message)||"删除失败")}catch(l){P.error("删除失败，请稍后重试")}})).catch((()=>{}));var s}),["stop"])},"删除",8,Z),c("button",{onClick:k((a=>Ba(e)),["stop"]),disabled:za.value,class:b({"is-liked":e.isLike||Ra.value.has(e.id)})},w(e.isLike||Ra.value.has(e.id)?"已收藏":"收藏"),11,ee)])],8,F)))),128))])):p("",!0)])),_:1}),u(t,{label:"推荐歌单",name:"recommendList"},{default:d((()=>[va.value.length>0?(n(),r("div",ae,[(n(!0),r(f,null,h(va.value,(e=>(n(),r("div",{key:e.id,class:"songlist-item",onClick:a=>ll(e.id)},[c("div",se,[c("img",{src:e.image||e.titleImg||"/music.png",alt:e.name},null,8,ie)]),c("div",te,[c("h3",oe,w(e.name),1),c("p",ne,w(e.message||"暂无简介"),1)]),c("div",re,[c("button",{onClick:k((a=>Ba(e)),["stop"]),disabled:za.value,class:b({"is-liked":e.isLike||Ra.value.has(e.id)})},w(e.isLike||Ra.value.has(e.id)?"已收藏":"收藏"),11,ce)])],8,le)))),128))])):p("",!0)])),_:1}),u(t,{label:"收藏歌单",name:"likeSongList"},{default:d((()=>[Ta.value.length>0?(n(),r("div",ue,[(n(!0),r(f,null,h(Ta.value,(e=>(n(),r("div",{key:e.id,class:"songlist-item",onClick:a=>ll(e.id)},[c("div",me,[c("img",{src:e.image||e.titleImg||"/music.png",alt:e.name},null,8,ve)]),c("div",ge,[c("h3",pe,w(e.name),1),c("p",fe,w(e.message||"暂无简介"),1)]),c("div",ye,[c("button",{onClick:k((a=>Ba(e)),["stop"]),disabled:za.value,class:b({"is-liked":e.isLike||Ra.value.has(e.id)})},w(e.isLike||Ra.value.has(e.id)?"已收藏":"收藏"),11,he)])],8,de)))),128))])):(n(),r("div",we,[...l[18]||(l[18]=[c("p",null,"暂无收藏歌单",-1)])]))])),_:1}),u(t,{label:"搜索结果",name:"searchResult"},{default:d((()=>[ga.value.length>0?(n(),r("div",ke,[(n(!0),r(f,null,h(ga.value,(e=>(n(),r("div",{key:e.id,class:"songlist-item",onClick:a=>ll(e.id)},[c("div",_e,[c("img",{src:e.image||e.titleImg||"/music.png",alt:e.name},null,8,Ce)]),c("div",Le,[c("h3",Ve,w(e.name),1),c("p",Ie,w(e.message||"暂无简介"),1)]),c("div",Ue,[c("button",{onClick:k((a=>Ba(e)),["stop"]),disabled:za.value,class:b({"is-liked":e.isLike||Ra.value.has(e.id)})},w(e.isLike||Ra.value.has(e.id)?"已收藏":"收藏"),11,xe)])],8,be)))),128))])):p("",!0)])),_:1})])),_:1},8,["modelValue"]),u(I,{modelValue:pa.value,"onUpdate:modelValue":l[3]||(l[3]=e=>pa.value=e),title:"歌单详情",width:"800px"},{default:d((()=>[ya.value?(n(),r("div",Se,[c("div",je,[c("img",{src:ya.value.image||ya.value.titleImg||"/music.png",alt:ya.value.name,class:"detail-cover"},null,8,Ee),c("div",Ne,[c("h2",null,w(ya.value.name),1),c("p",null,"创建时间: "+w(Ja(ya.value.createDate)),1),c("p",null,w(ya.value.message||"暂无简介"),1)])]),c("div",Ae,[l[21]||(l[21]=c("h3",null,"歌曲列表",-1)),u(L,{data:ya.value.songList||[],style:{width:"100%"}},{default:d((()=>[u(C,{label:"操作",width:"80",align:"center"},{default:d((a=>[u(s,{type:"danger",size:"small",onClick:l=>e.removeSong(a.row,a.$index),"confirm-type":"danger"},{default:d((()=>[...l[19]||(l[19]=[y("移除",-1)])])),_:1},8,["onClick"])])),_:1}),u(C,{label:"歌曲名称","min-width":"100"},{default:d((e=>[y(w(e.row.musicName||"未知歌曲"),1)])),_:1}),u(C,{label:"封面","min-width":"100"},{default:d((e=>[e.row.imageUrl?(n(),r("img",{key:0,src:e.row.imageUrl,alt:e.row.musicName,class:"song-cover-small"},null,8,De)):(n(),r("span",Re,"暂无封面"))])),_:1}),u(C,{label:"歌手","min-width":"120"},{default:d((e=>[y(w(e.row.singerUsername||"未知歌手"),1)])),_:1}),u(C,{label:"创建时间","min-width":"150"},{default:d((e=>[y(w(e.row.createTime||"未知"),1)])),_:1}),u(C,{label:"",width:"80",align:"center"},{default:d((e=>[...l[20]||(l[20]=[])])),_:1})])),_:1},8,["data"])])])):(n(),r("div",Te,[u(V,{rows:6,animated:""})]))])),_:1},8,["modelValue"]),u(I,{modelValue:fa.value,"onUpdate:modelValue":l[8]||(l[8]=e=>fa.value=e),title:ha.value?"编辑歌单":"创建歌单",width:"500px"},{footer:d((()=>[u(s,{onClick:l[7]||(l[7]=e=>fa.value=!1)},{default:d((()=>[...l[23]||(l[23]=[y("取消",-1)])])),_:1}),u(s,{type:"primary",onClick:rl},{default:d((()=>[...l[24]||(l[24]=[y("确定",-1)])])),_:1})])),default:d((()=>[u(j,{model:Ga,rules:Ha,ref:"songListFormRef"},{default:d((()=>[u(U,{label:"歌单名称",prop:"name"},{default:d((()=>[u(i,{modelValue:Ga.name,"onUpdate:modelValue":l[4]||(l[4]=e=>Ga.name=e),placeholder:"请输入歌单名称"},null,8,["modelValue"])])),_:1}),u(U,{label:"歌单简介",prop:"message"},{default:d((()=>[u(i,{modelValue:Ga.message,"onUpdate:modelValue":l[5]||(l[5]=e=>Ga.message=e),placeholder:"请输入歌单简介",type:"textarea",rows:3},null,8,["modelValue"])])),_:1}),u(U,{label:"歌单标签",prop:"tags"},{default:d((()=>[u(i,{modelValue:Ga.tags,"onUpdate:modelValue":l[6]||(l[6]=e=>Ga.tags=e),placeholder:"请输入标签，用逗号分隔"},null,8,["modelValue"])])),_:1}),u(U,{label:"歌单封面"},{default:d((()=>[u(x,{class:"avatar-uploader","http-request":tl,"before-upload":il,"show-file-list":!1,action:"#",accept:"image/*","auto-upload":!0},{default:d((()=>[Ga.image?(n(),r("img",{key:0,src:Ga.image,class:"avatar"},null,8,ze)):(n(),r("div",Pe,[...l[22]||(l[22]=[c("i",{class:"el-icon-plus avatar-uploader-icon"},null,-1),c("span",{class:"upload-text"},"上传封面",-1)])]))])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])]),u(I,{modelValue:wa.value,"onUpdate:modelValue":l[10]||(l[10]=e=>wa.value=e),title:ka.value.name||"歌单详情",width:"800px","before-close":Ya},{header:d((()=>[c("div",$e,[c("span",null,w(ka.value.name||"歌单详情"),1),u(s,{type:"primary",size:"small",onClick:qa},{default:d((()=>[...l[25]||(l[25]=[y("添加歌曲",-1)])])),_:1})])])),footer:d((()=>[u(s,{onClick:Ya},{default:d((()=>[...l[31]||(l[31]=[y("关闭",-1)])])),_:1})])),default:d((()=>[c("div",Be,[c("div",Ke,[c("div",Me,[c("img",{src:ka.value.image||ka.value.titleImg||"/music.png",alt:ka.value.name,class:"cover-img"},null,8,Oe)]),c("div",qe,[c("h2",Fe,w(ka.value.name||"未知歌单"),1),c("p",Ge,w(ka.value.message||"暂无简介"),1),c("div",He,[c("span",null,"歌曲数量："+w(ba.value.length),1)])])]),l[30]||(l[30]=c("h3",{class:"section-title"},"歌曲列表",-1)),c("div",Je,[u(i,{modelValue:Ua.value,"onUpdate:modelValue":l[9]||(l[9]=e=>Ua.value=e),placeholder:"搜索歌单中的歌曲","prefix-icon":"el-icon-search",clearable:"",onKeyup:m(Ma,["enter"])},{append:d((()=>[u(s,{onClick:Ma},{default:d((()=>[...l[26]||(l[26]=[y("搜索",-1)])])),_:1})])),_:1},8,["modelValue"])]),ba.value.length>0?(n(),r("div",Qe,[u(L,{data:xa.value,stripe:"",style:{width:"100%"},onSelectionChange:Wa,"row-class-name":(e,a)=>0===e.activation?"frozen-row":a%2==0?"even-row":"odd-row"},{default:d((()=>[u(C,{prop:"id",label:"#",width:"60",align:"center"}),u(C,{label:"歌曲名","min-width":"200"},{default:d((e=>[c("div",We,[e.row.imageUrl?(n(),r("img",{key:0,src:e.row.imageUrl,alt:e.row.musicName,class:"song-cover-small",onClick:a=>Ka(e.row)},null,8,Xe)):(n(),r("img",{key:1,src:"/music.png",alt:"默认封面",class:"song-cover-small",onClick:a=>Ka(e.row)},null,8,Ye)),c("span",Ze,w(e.row.musicName),1)])])),_:1}),u(C,{label:"歌手","min-width":"120"},{default:d((e=>[y(w(e.row.singerUsername||"未知歌手"),1)])),_:1}),u(C,{label:"创建时间","min-width":"150"},{default:d((e=>[y(w(e.row.createTime||"未知"),1)])),_:1}),u(C,{label:"收藏",width:"100",align:"center"},{default:d((e=>[u(s,{type:"primary",size:"small",icon:Na.value.has(e.row.musicId)?"el-icon-star-on":"el-icon-star-off",onClick:a=>(async e=>{if(!Aa.value){Aa.value=!0;try{const a=e.musicId;if(Na.value.has(a)){const l=await D(a);20===l.code||l.success||200===l.code?(e.isLike=0,Na.value.delete(a),P.success("取消收藏成功")):P.error("取消收藏失败，请稍后重试")}else{const l=await A(a);20===l.code||l.success||200===l.code?(e.isLike=1,Na.value.add(a),P.success("收藏成功")):P.error("收藏失败，请稍后重试")}}catch(a){P.error("操作失败，请稍后重试")}finally{Aa.value=!1}}})(e.row),disabled:Aa.value},{default:d((()=>[y(w(Na.value.has(e.row.musicId)?"已收藏":"收藏"),1)])),_:2},1032,["icon","onClick","disabled"])])),_:1}),u(C,{label:"",width:"80",align:"center"},{default:d((e=>[...l[27]||(l[27]=[])])),_:1})])),_:1},8,["data","row-class-name"])])):Ua.value&&ba.value.length>0?(n(),r("div",ea,[u(E,{description:"未找到匹配的歌曲"},{default:d((()=>[u(s,{type:"primary",onClick:Oa},{default:d((()=>[...l[28]||(l[28]=[y("重置搜索",-1)])])),_:1})])),_:1})])):(n(),r("div",aa,[...l[29]||(l[29]=[c("p",null,"暂无歌曲",-1)])]))])])),_:1},8,["modelValue","title"]),u(I,{modelValue:_a.value,"onUpdate:modelValue":l[12]||(l[12]=e=>_a.value=e),title:"搜索歌曲添加到歌单",width:"800px","before-close":Fa},{footer:d((()=>[u(s,{onClick:Fa},{default:d((()=>[...l[34]||(l[34]=[y("取消",-1)])])),_:1}),u(s,{type:"primary",onClick:Xa},{default:d((()=>[...l[35]||(l[35]=[y("添加选中歌曲",-1)])])),_:1})])),default:d((()=>[c("div",la,[c("div",sa,[u(i,{modelValue:Ca.value,"onUpdate:modelValue":l[11]||(l[11]=e=>Ca.value=e),placeholder:"搜索歌曲","prefix-icon":"el-icon-search",clearable:"",onKeyup:m(Qa,["enter"])},{append:d((()=>[u(s,{type:"primary",onClick:Qa},{default:d((()=>[...l[32]||(l[32]=[y("搜索",-1)])])),_:1})])),_:1},8,["modelValue"])]),c("div",ia,[u(L,{data:La.value,stripe:"",style:{width:"100%"},onSelectionChange:Wa,"row-key":e=>e.musicId},{default:d((()=>[u(C,{type:"selection",width:"55"}),u(C,{prop:"musicId",label:"#",width:"60",align:"center"}),u(C,{label:"歌曲名","min-width":"200"},{default:d((e=>[c("div",ta,[e.row.imageUrl?(n(),r("img",{key:0,src:e.row.imageUrl,alt:e.row.musicName,class:"song-cover-small"},null,8,oa)):(n(),r("img",{key:1,src:"/music.png",alt:"默认封面",class:"song-cover-small"})),c("span",na,w(e.row.musicName),1)])])),_:1}),u(C,{label:"歌手","min-width":"120"},{default:d((e=>[y(w(e.row.singerUsername||"未知歌手"),1)])),_:1}),u(C,{label:"专辑","min-width":"150"},{default:d((e=>[y(w(e.row.musicAlbum||"未知专辑"),1)])),_:1}),u(C,{label:"",width:"80",align:"center"},{default:d((e=>[...l[33]||(l[33]=[])])),_:1})])),_:1},8,["data","row-key"])])])])),_:1},8,["modelValue"]),ja.value?(n(),v(g(ra),{key:0,"audio-url":Sa.value,autoplay:!0,ref_key:"musicPlayerRef",ref:Ea},null,8,["audio-url"])):p("",!0)],64)}}},[["__scopeId","data-v-f6b48b0a"]]);export{ra as default};
